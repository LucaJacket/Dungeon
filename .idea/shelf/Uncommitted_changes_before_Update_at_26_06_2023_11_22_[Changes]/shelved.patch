Index: src/main/java/com/lgiacchetta/dungeon/DungeonApp.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lgiacchetta.dungeon;\r\n\r\nimport com.almasb.fxgl.app.GameApplication;\r\nimport com.almasb.fxgl.app.GameSettings;\r\nimport com.almasb.fxgl.app.scene.LoadingScene;\r\nimport com.almasb.fxgl.app.scene.SceneFactory;\r\nimport com.almasb.fxgl.app.scene.Viewport;\r\nimport com.almasb.fxgl.dsl.FXGL;\r\nimport com.almasb.fxgl.entity.Entity;\r\nimport com.almasb.fxgl.input.UserAction;\r\nimport com.almasb.fxgl.physics.CollisionHandler;\r\nimport javafx.geometry.Insets;\r\nimport javafx.geometry.Pos;\r\nimport javafx.scene.input.KeyCode;\r\nimport javafx.scene.layout.HBox;\r\nimport javafx.scene.layout.VBox;\r\nimport javafx.scene.paint.Color;\r\n\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class DungeonApp extends GameApplication {\r\n    private Entity player1;\r\n    private Entity player2;\r\n    private VBox healthBars;\r\n    private int currentLevel = 0;\r\n    private GameOverScene gameOverScene;\r\n    private LevelEndScene levelEndScene;\r\n    private GameEndedScene gameEndedScene;\r\n\r\n    @Override\r\n    protected void initSettings(GameSettings settings) {\r\n        settings.setWidth(1280);\r\n        settings.setHeight(720);\r\n        settings.setSceneFactory(new SceneFactory() {\r\n            @Override\r\n            public LoadingScene newLoadingScene() {\r\n                return new MainLoadingScene();\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    protected void initGameVars(Map<String, Object> vars) {\r\n        vars.put(\"idlePlayer1\", \"hero/knight_m_idle_anim_f\");\r\n        vars.put(\"walkPlayer1\", \"hero/knight_m_run_anim_f\");\r\n        vars.put(\"idlePlayer2\", \"hero/knight_f_idle_anim_f\");\r\n        vars.put(\"walkPlayer2\", \"hero/knight_f_run_anim_f\");\r\n    }\r\n\r\n    @Override\r\n    protected void initInput() {\r\n        FXGL.getInput().addAction(new UserAction(\"Up1\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player1.getComponent(PlayerComponent.class).up();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player1.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.W); // move player1\r\n        FXGL.getInput().addAction(new UserAction(\"Left1\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player1.getComponent(PlayerComponent.class).left();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player1.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.A);\r\n        FXGL.getInput().addAction(new UserAction(\"Down1\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player1.getComponent(PlayerComponent.class).down();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player1.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.S);\r\n        FXGL.getInput().addAction(new UserAction(\"Right1\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player1.getComponent(PlayerComponent.class).right();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player1.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.D);\r\n        FXGL.getInput().addAction(new UserAction(\"Up2\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player2.getComponent(PlayerComponent.class).up();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player2.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.UP); // move player2\r\n        FXGL.getInput().addAction(new UserAction(\"Left2\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player2.getComponent(PlayerComponent.class).left();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player2.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.LEFT);\r\n        FXGL.getInput().addAction(new UserAction(\"Down2\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player2.getComponent(PlayerComponent.class).down();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player2.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.DOWN);\r\n        FXGL.getInput().addAction(new UserAction(\"Right2\") {\r\n            @Override\r\n            protected void onAction() {\r\n                player2.getComponent(PlayerComponent.class).right();\r\n            }\r\n\r\n            @Override\r\n            protected void onActionEnd() {\r\n                player2.getComponent(PlayerComponent.class).stop();\r\n            }\r\n        }, KeyCode.RIGHT);\r\n    }\r\n\r\n    @Override\r\n    protected void initPhysics() {\r\n        FXGL.getPhysicsWorld().setGravity(0.0,0.0); // top-down view\r\n        FXGL.getPhysicsWorld().addCollisionHandler(\r\n                new CollisionHandler(EntityType.PLAYER, EntityType.PLAYER) {\r\n                    @Override\r\n                    protected void onCollisionEnd(Entity a, Entity b) {\r\n                        a.getComponent(PlayerComponent.class).stop();\r\n                        b.getComponent(PlayerComponent.class).stop();\r\n                    }\r\n                });\r\n        FXGL.getPhysicsWorld().addCollisionHandler( // damage player\r\n                new CollisionHandler(EntityType.PLAYER, EntityType.SPIKE) {\r\n            @Override\r\n            protected void onCollision(Entity a, Entity b) {\r\n                if (b.getComponent(SpikeComponent.class).isDangerous()) {\r\n                    a.getComponent(PlayerComponent.class).damage(0.5);\r\n                    healthBars = updateHealth(healthBars);\r\n                }\r\n            }\r\n        });\r\n        FXGL.getPhysicsWorld().addCollisionHandler( // activate plate\r\n                new CollisionHandler(EntityType.PLAYER, EntityType.PLATE) {\r\n            @Override\r\n            protected void onCollisionBegin(Entity a, Entity b) {\r\n                b.getComponent(PlateComponent.class).change();\r\n            }\r\n\r\n            @Override\r\n            protected void onCollisionEnd(Entity a, Entity b) {\r\n                b.getComponent(PlateComponent.class).change();\r\n            }\r\n        });\r\n        FXGL.getPhysicsWorld().addCollisionHandler( // teleport\r\n                new CollisionHandler(EntityType.PLAYER, EntityType.LADDER) {\r\n            @Override\r\n            protected void onCollisionBegin(Entity a, Entity b) {\r\n                List<Entity> ladders = FXGL.getGameWorld().getEntitiesByType(EntityType.LADDER);\r\n                ladders.remove(b);\r\n                for (Entity ladder : ladders) {\r\n                    if (ladder.getComponent(LadderComponent.class).getConnectedLadder() ==\r\n                        b.getComponent(LadderComponent.class).getConnectedLadder()) {\r\n                        a.getComponent(PlayerComponent.class).teleport(ladder.getCenter());\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        FXGL.getPhysicsWorld().addCollisionHandler( // end level\r\n                new CollisionHandler(EntityType.PLAYER, EntityType.EXIT) {\r\n                    @Override\r\n                    protected void onCollisionBegin(Entity a, Entity b) {\r\n                        levelEndScene.onLevelEnd();\r\n                    }\r\n                });\r\n    }\r\n\r\n    @Override\r\n    protected void initGame() {\r\n        gameOverScene = new GameOverScene(this::onPlayerDied);\r\n        levelEndScene = new LevelEndScene(this::onLevelFinish);\r\n        gameEndedScene = new GameEndedScene(this::onGameFinish);\r\n\r\n        FXGL.getGameScene().setBackgroundColor(Color.BLACK);\r\n        FXGL.getGameWorld().addEntityFactory(new DungeonFactory());\r\n\r\n        setLevel(currentLevel);\r\n    }\r\n\r\n    @Override\r\n    protected void onPreInit() {\r\n        FXGL.getSettings().setGlobalMusicVolume(0.25);\r\n        FXGL.getSettings().setGlobalSoundVolume(0.5);\r\n\r\n        FXGL.loopBGM(\"melody.wav\");\r\n    }\r\n\r\n    @Override\r\n    protected void onUpdate(double tpf) {\r\n        if (player1.getComponent(PlayerComponent.class).getHealth() == 0.0 ||\r\n            player2.getComponent(PlayerComponent.class).getHealth() == 0.0) {\r\n            gameOverScene.onGameOver();\r\n        }\r\n    }\r\n\r\n    private VBox updateHealth(VBox prevHealthBars) {\r\n        VBox vbox = new VBox(2.0);\r\n        vbox.setPadding(new Insets(8.0));\r\n\r\n        Entity[] players = {player1, player2};\r\n        Arrays.stream(players).forEach(player -> {\r\n            HBox hbox = new HBox(2.0);\r\n            hbox.setAlignment(Pos.BASELINE_CENTER);\r\n\r\n            double health = player.getComponent(PlayerComponent.class).getHealth();\r\n\r\n            hbox.getChildren().add(FXGL.getAssetLoader().loadTexture(\r\n                    FXGL.gets(\"idlePlayer\" + player.getProperties().getValue(\"type\")) + \"0.png\"));\r\n            for (int i = 0; i < Math.floor(health); i++) {\r\n                hbox.getChildren().add(FXGL.getAssetLoader().loadTexture(\"heart/ui_heart_full.png\"));\r\n            }\r\n            if (Math.ceil(health) > Math.floor(health)) {\r\n                hbox.getChildren().add(FXGL.getAssetLoader().loadTexture(\"heart/ui_heart_half.png\"));\r\n            }\r\n            for (int i = 0; i < 3 - Math.ceil(health); i++) {\r\n                hbox.getChildren().add(FXGL.getAssetLoader().loadTexture(\"heart/ui_heart_empty.png\"));\r\n            }\r\n\r\n            vbox.getChildren().add(hbox);\r\n        });\r\n\r\n        if (prevHealthBars != null)\r\n            FXGL.getGameScene().getContentRoot().getChildren().remove(prevHealthBars);\r\n        FXGL.getGameScene().getContentRoot().getChildren().add(vbox);\r\n\r\n        return vbox;\r\n    }\r\n\r\n    public void setLevel(int level) {\r\n        currentLevel = level;\r\n        FXGL.setLevelFromMap(\"tmx/test-map-no-anim.tmx\");\r\n\r\n        FXGL.getGameWorld().getEntitiesByType(EntityType.PLAYER).forEach(player -> {\r\n            if (player.getProperties().getValue(\"type\").equals(1))\r\n                player1 = player;\r\n            else\r\n                player2 = player;\r\n        });\r\n\r\n        Viewport viewport = FXGL.getGameScene().getViewport();\r\n        viewport.bindToFit(FXGL.getAppWidth() / 4.0, FXGL.getAppHeight() / 4.0, player1, player2);\r\n        viewport.setLazy(true); // feels better\r\n\r\n        healthBars = updateHealth(null);\r\n    }\r\n\r\n    public void onPlayerDied() {\r\n        setLevel(currentLevel);\r\n    }\r\n\r\n    public void onGameFinish() {\r\n        currentLevel = 0;\r\n        setLevel(currentLevel);\r\n    }\r\n\r\n    public void onLevelFinish() {\r\n        currentLevel++;\r\n\r\n        if (currentLevel == 3) { // 3 is MAX_LEVEL\r\n            gameEndedScene.onGameEnded();\r\n        } else {\r\n            setLevel(currentLevel);\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        launch(args);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/lgiacchetta/dungeon/DungeonApp.java b/src/main/java/com/lgiacchetta/dungeon/DungeonApp.java
--- a/src/main/java/com/lgiacchetta/dungeon/DungeonApp.java	
+++ b/src/main/java/com/lgiacchetta/dungeon/DungeonApp.java	
@@ -260,7 +260,7 @@
 
     public void setLevel(int level) {
         currentLevel = level;
-        FXGL.setLevelFromMap("tmx/test-map-no-anim.tmx");
+        FXGL.setLevelFromMap("tmx/level2.tmx");
 
         FXGL.getGameWorld().getEntitiesByType(EntityType.PLAYER).forEach(player -> {
             if (player.getProperties().getValue("type").equals(1))
Index: src/main/resources/assets/levels/tmx/test-map-no-anim.tmx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<map version=\"1.10\" tiledversion=\"1.10.1\" orientation=\"orthogonal\" renderorder=\"right-down\" width=\"30\" height=\"30\" tilewidth=\"16\" tileheight=\"16\" infinite=\"0\" nextlayerid=\"6\" nextobjectid=\"44\">\r\n <tileset firstgid=\"1\" name=\"tiles_spritesheet\" tilewidth=\"16\" tileheight=\"16\" tilecount=\"1024\" columns=\"32\">\r\n  <image source=\"tiles_spritesheet.png\" trans=\"000000\" width=\"512\" height=\"512\"/>\r\n </tileset>\r\n <layer id=\"1\" name=\"floor\" width=\"30\" height=\"30\" locked=\"1\">\r\n  <data encoding=\"csv\">\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\r\n</data>\r\n </layer>\r\n <layer id=\"2\" name=\"walls\" width=\"30\" height=\"30\" locked=\"1\">\r\n  <data encoding=\"csv\">\r\n2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,\r\n34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,451,452,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,451,452,0,0,0,0,0,\r\n2,3,3,3,482,0,0,485,3,3,3,4,0,0,0,0,0,0,2,3,3,3,482,0,0,485,3,3,3,4,\r\n34,35,35,35,66,0,0,66,35,35,35,36,0,0,0,0,0,0,34,35,35,35,67,0,0,67,35,35,35,36,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n2,3,3,3,3,3,3,3,3,3,3,4,0,0,0,0,0,0,2,3,3,3,3,3,3,3,3,3,3,4,\r\n34,35,35,35,35,35,35,35,35,35,35,36,0,0,0,0,0,0,34,35,35,35,35,35,35,35,35,35,35,36,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,\r\n34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36\r\n</data>\r\n </layer>\r\n <layer id=\"3\" name=\"side-walls\" width=\"30\" height=\"30\" locked=\"1\">\r\n  <data encoding=\"csv\">\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,324,0,0,0,0,0,0,323,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,321,0,0,0,0,0,0,322,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,353,0,0,0,0,0,0,354,0,0,0,0,0,0,0,0,0,0,324,\r\n323,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,324,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\r\n</data>\r\n </layer>\r\n <objectgroup id=\"4\" name=\"obj\">\r\n  <object id=\"1\" name=\"up-wall\" type=\"wall\" x=\"-2.13163e-14\" y=\"12\" width=\"480\" height=\"5\"/>\r\n  <object id=\"2\" name=\"down-wall\" type=\"wall\" x=\"-2.13163e-14\" y=\"460\" width=\"480\" height=\"5\"/>\r\n  <object id=\"3\" name=\"right-wall\" type=\"wall\" x=\"475\" y=\"12\" width=\"5\" height=\"453\"/>\r\n  <object id=\"4\" name=\"left-wall\" type=\"wall\" x=\"-2.13163e-14\" y=\"12\" width=\"5\" height=\"453\"/>\r\n  <object id=\"5\" name=\"top-right-wall\" type=\"wall\" x=\"288\" y=\"64\" width=\"5\" height=\"64\"/>\r\n  <object id=\"6\" name=\"top-left-wall\" type=\"wall\" x=\"187\" y=\"64\" width=\"5\" height=\"64\"/>\r\n  <object id=\"7\" name=\"bottom-right-wall\" type=\"wall\" x=\"288\" y=\"352\" width=\"5\" height=\"72\"/>\r\n  <object id=\"8\" name=\"bottom-left-wall\" type=\"wall\" x=\"187\" y=\"352\" width=\"5\" height=\"72\"/>\r\n  <object id=\"9\" name=\"top-left-wall\" type=\"wall\" x=\"112\" y=\"124\" width=\"80\" height=\"5\"/>\r\n  <object id=\"35\" name=\"top-left-wall\" type=\"wall\" x=\"0\" y=\"124\" width=\"80\" height=\"5\"/>\r\n  <object id=\"11\" name=\"bottom-right-wall\" type=\"wall\" x=\"288\" y=\"348\" width=\"187\" height=\"5\"/>\r\n  <object id=\"12\" name=\"bottom-left-wall\" type=\"wall\" x=\"5\" y=\"348\" width=\"187\" height=\"5\"/>\r\n  <object id=\"21\" name=\"spike\" type=\"spike\" x=\"192\" y=\"160\" width=\"16\" height=\"2\"/>\r\n  <object id=\"22\" name=\"spike\" type=\"spike\" x=\"208\" y=\"160\" width=\"16\" height=\"2\"/>\r\n  <object id=\"23\" name=\"spike\" type=\"spike\" x=\"224\" y=\"160\" width=\"16\" height=\"2\"/>\r\n  <object id=\"24\" name=\"spike\" type=\"spike\" x=\"240\" y=\"160\" width=\"16\" height=\"2\"/>\r\n  <object id=\"25\" name=\"spike\" type=\"spike\" x=\"256\" y=\"160\" width=\"16\" height=\"2\"/>\r\n  <object id=\"26\" name=\"spike\" type=\"spike\" x=\"272\" y=\"160\" width=\"16\" height=\"2\"/>\r\n  <object id=\"27\" name=\"ladder\" type=\"ladder\" x=\"80\" y=\"64\" width=\"16\" height=\"2\">\r\n   <properties>\r\n    <property name=\"connected\" type=\"int\" value=\"1\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"30\" name=\"ladder\" type=\"ladder\" x=\"384\" y=\"64\" width=\"16\" height=\"2\">\r\n   <properties>\r\n    <property name=\"connected\" type=\"int\" value=\"1\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"31\" name=\"red-plate\" type=\"plate\" x=\"144\" y=\"64\" width=\"16\" height=\"2\">\r\n   <properties>\r\n    <property name=\"color\" value=\"red\"/>\r\n    <property name=\"connected\" type=\"int\" value=\"1\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"32\" name=\"blue-plate\" type=\"plate\" x=\"320\" y=\"64\" width=\"16\" height=\"2\">\r\n   <properties>\r\n    <property name=\"color\" value=\"blue\"/>\r\n    <property name=\"connected\" type=\"int\" value=\"2\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"33\" name=\"ladder\" type=\"ladder\" x=\"144\" y=\"400\" width=\"16\" height=\"2\">\r\n   <properties>\r\n    <property name=\"connected\" type=\"int\" value=\"2\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"34\" name=\"ladder\" type=\"ladder\" x=\"320\" y=\"400\" width=\"16\" height=\"2\">\r\n   <properties>\r\n    <property name=\"connected\" type=\"int\" value=\"2\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"36\" name=\"top-right-wall\" type=\"wall\" x=\"400\" y=\"124\" width=\"80\" height=\"5\"/>\r\n  <object id=\"37\" name=\"top-right-wall\" type=\"wall\" x=\"288\" y=\"124\" width=\"80\" height=\"5\"/>\r\n  <object id=\"38\" name=\"left-door\" type=\"door\" x=\"80\" y=\"112\" width=\"32\" height=\"17\">\r\n   <properties>\r\n    <property name=\"connected\" type=\"int\" value=\"1\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"39\" name=\"right-door\" type=\"door\" x=\"368\" y=\"112\" width=\"32\" height=\"17\">\r\n   <properties>\r\n    <property name=\"connected\" type=\"int\" value=\"2\"/>\r\n   </properties>\r\n  </object>\r\n  <object id=\"40\" name=\"player1\" type=\"player\" x=\"240\" y=\"240\">\r\n   <properties>\r\n    <property name=\"type\" type=\"int\" value=\"1\"/>\r\n   </properties>\r\n   <point/>\r\n  </object>\r\n  <object id=\"41\" name=\"player2\" type=\"player\" x=\"272\" y=\"240\">\r\n   <properties>\r\n    <property name=\"type\" type=\"int\" value=\"2\"/>\r\n   </properties>\r\n   <point/>\r\n  </object>\r\n </objectgroup>\r\n</map>\r\n
===================================================================
diff --git a/src/main/resources/assets/levels/tmx/test-map-no-anim.tmx b/src/main/resources/assets/levels/tmx/test-map-no-anim.tmx
--- a/src/main/resources/assets/levels/tmx/test-map-no-anim.tmx	
+++ b/src/main/resources/assets/levels/tmx/test-map-no-anim.tmx	
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<map version="1.10" tiledversion="1.10.1" orientation="orthogonal" renderorder="right-down" width="30" height="30" tilewidth="16" tileheight="16" infinite="0" nextlayerid="6" nextobjectid="44">
+<map version="1.10" tiledversion="1.10.1" orientation="orthogonal" renderorder="right-down" width="30" height="30" tilewidth="16" tileheight="16" infinite="0" nextlayerid="7" nextobjectid="46">
  <tileset firstgid="1" name="tiles_spritesheet" tilewidth="16" tileheight="16" tilecount="1024" columns="32">
   <image source="tiles_spritesheet.png" trans="000000" width="512" height="512"/>
  </tileset>
